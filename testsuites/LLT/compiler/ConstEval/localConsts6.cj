// Copyright (c) Huawei Technologies Co., Ltd. 2025. All rights reserved.
// This source file is part of the Cangjie project, licensed under Apache-2.0
// with Runtime Library Exception.
//
// See https://cangjie-lang.cn/pages/LICENSE for license information.

// DEPENDENCE: %n.expect.out
// (DEBUG_OPTION)EXEC: %compiler %debugCHIROpt %n.cj -o %output 2>&1 | compare %f
// (DEBUG_OPTION)EXEC: %run %run_opt %output %run_args 2>&1 > %n.real.out
// (DEBUG_OPTION)EXEC: %diff %n.expect.out %n.real.out
// ASSERT: scan debug: consteval at localConsts6.cj:33:5 - localConsts6.cj:39:31 replaced initializer function `gv$_LOCAL_1` with initializer constant(s).
// ASSERT: scan debug: consteval at localConsts6.cj:24:1 - localConsts6.cj:30:27 replaced initializer function `gv$_GLOBAL_1` with initializer constant(s).
// ASSERT: scan-not core dumped
// ASSERT: scan-not stack trace

const func inc(x: Int64) {
    x + 1
}

const func dec(x: Int64) {
    x - 1
}

const GLOBAL_1 = if (inc(1) == 2) {
                    if (dec(2) == 1) {
                        42
                    } else {
                        0
                    }
                } else {0}

func f(): Int64 {
    const LOCAL_1 = if (inc(1) == 2) {
                        if (dec(2) == 1) {
                            42
                        } else {
                            0
                        }
                    } else {0}
    LOCAL_1
}

main () {
    println("GLOBAL_1: " + GLOBAL_1.toString())
    println("f(): " + f().toString())
    0
}