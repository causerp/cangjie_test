// Copyright (c) Huawei Technologies Co., Ltd. 2025. All rights reserved.
// This source file is part of the Cangjie project, licensed under Apache-2.0
// with Runtime Library Exception.
//
// See https://cangjie-lang.cn/pages/LICENSE for license information.

// (CJNATIVE and not Windows) DEPENDENCE: ../Cangjie.h
// (CJNATIVE and not Windows) DEPENDENCE: ../%n
// (CJNATIVE and not Windows) RUN-EXEC-0: %cd %n && mkdir -p out
// (CJNATIVE and not Windows) RUN-EXEC-0: %cd %n && %compiler %compile_shared_lib_opt %overflowOpt -p src/cjworld %import_objc_interop -o out
// (CJNATIVE and Linux) RUN-EXEC-0: %cd %n && sed -i "s/\.dylib/\.so/g" objc-gen/*
// (CJNATIVE and Linux) RUN-EXEC-0: %cd %n && %clang %objc_flags %objc_base_libs %objc_arc_opt src/objc/*.m objc-gen/*.m -o out/main -Lout %cangjie_runtime_link -I../ -Isrc/objc -Iobjc-gen %include_cangjie -lcjworld -lcangjie-runtime -ldl
// (CJNATIVE and Darwin) RUN-EXEC-0: %cd %n && %clang %modules_opt %objc_arc_opt src/objc/*.m objc-gen/*.m -o out/main -Lout %cangjie_runtime_link -I../ -Isrc/objc -Iobjc-gen %include_cangjie -lcjworld -lcangjie-runtime
// (CJNATIVE and not Windows) RUN-EXEC-PIPE: %cd %n/out && ./main 2>& 1 | compare %f

/* SCAN-IN
objc: [M init]
objc: [M1 initWithValue:0]
objc: [M1 initWithValue:1]
objc: [M1 initWithValue:2]
objc: [M init]
objc: [M1 initWithValue:3]
objc: [M1 initWithValue:4]
cj: A()
cj: I implement Checker method `check`
objc: [M init]
objc: [M1 initWithValue:5]
objc: [M1 initWithValue:6]
cj: call method directly on M class
objc: [M fooRetObjCIdWithArg0:andArg1:]
objc: Now I will call [arg1 identity]
cj: I'm a class A instance
cj: Now, I will call super.identity()
objc: I'm a class M instance
cj: call overridden method of ProtoM interface
objc: [M idProp]
cj: func fooRetObjCIdWithArg0(arg0: ObjCId)
cj: Now, I will call super.fooRetObjCIdWithArg0
objc: [M fooRetObjCIdWithArg0:]
cj: call not overridden method of ProtoM interface
objc: [M protoProp]
objc: [M fooRetProtoM1WithArg0:]
objc: Now I will send [arg0 identity]
objc: I'm a class M1 instance, self->value=4
cj: call identity on protoField
objc: I'm a class M1 instance, self->value=4
cj: call identity on sProtoProp
objc: [M sProtoProp]
objc: I'm a class M1 instance, self->value=2
*/
