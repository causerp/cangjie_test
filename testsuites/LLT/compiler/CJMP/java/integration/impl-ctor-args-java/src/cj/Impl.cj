// Copyright (c) Huawei Technologies Co., Ltd. 2025. All rights reserved.
// This source file is part of the Cangjie project, licensed under Apache-2.0
// with Runtime Library Exception.
//
// See https://cangjie-lang.cn/pages/LICENSE for license information.

package cj

import interoplib.interop.*
import java.lang.JObject

@JavaImpl
public class Impl <: MyObject {
    public init(a: Int64, b: Bool) {
        println("cangjie: Impl(${a}, ${b})")
        assert(a, 5)
        assert(b, true)
    }

    public init(obj: JObject, myobj: MyObject) {
        println("cangjie: Impl(JObject, MyObject)")
        assert(myobj.isValid(), true)
        assert(obj.hashCode32(), 5)
    }

    public init(arg: ?JObject) {
        println("cangjie: Impl(?JObject - ${if (arg.isSome()) { "not " } else { "" } + "null" }})")
        match (arg) {
            case Some(obj) => assert(obj.hashCode32(), 5)
            case _ => ()
        }
    }
}

func assert<T>(left: Equatable<T>, right: T) {
    if (left != right) {
        let str = if (left is ToString && right is ToString) {
            "${(left as ToString).getOrThrow()} != ${(right as ToString).getOrThrow()}"
        } else {
            "values must be equal"
        }
        throw Exception("Assertion failed: ${str}")
    }
}